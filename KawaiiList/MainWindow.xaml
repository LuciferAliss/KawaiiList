<Window x:Class="KawaiiList.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:components="clr-namespace:KawaiiList.Components"
        xmlns:viewmodels="clr-namespace:KawaiiList.ViewModels"
        xmlns:views="clr-namespace:KawaiiList.Views"
        mc:Ignorable="d"
        Title="MainPage"
        MinHeight="720"
        MinWidth="1280"
        Width="{Binding ScreenWidth}"
        WindowStartupLocation="CenterScreen"
        WindowState="{Binding WindowState}"
        WindowStyle="None"
        Background="Transparent"
        AllowsTransparency="True"
        MouseDown="WindowMouseDoun">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>


    <Border CornerRadius="12"
            BorderThickness="3">

        <Border.BorderBrush>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="{StaticResource BorderWindowBlueColor}" Offset="0"/>
                <GradientStop Color="{StaticResource BorderPurplWindowPinkColor}" Offset="0.75"/>
                <GradientStop Color="{StaticResource BorderWindowPurpleColor}" Offset="1"/>
            </LinearGradientBrush>
        </Border.BorderBrush>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Боковая панель -->
            <components:NavigationBarComponent Grid.Column="0"
                                               VerticalAlignment="Stretch"
                                               DataContext="{Binding NavigationBarViewModel}"
                                               Visibility="{Binding DataContext.IsFullscreen, 
                                                        RelativeSource={RelativeSource AncestorType=Window}, 
                                                        Converter={StaticResource BooleanToVisibilityConverter}}"/>

            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!--// Панель управления //-->
                <Border Grid.Row="0"
                        CornerRadius="0,12,0,0"
                        Background="#252A36"
                        Visibility="{Binding IsFullscreen, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <StackPanel Orientation="Horizontal"  HorizontalAlignment="Right">

                        <Button Style="{DynamicResource MaterialDesignFlatButton}"
                                Height="30"
                                Width="60">
                            <materialDesign:PackIcon Kind="minus"
                                                     Foreground="White"
                                                     Height="20"
                                                     Width="20"
                                                     VerticalAlignment="Center"/>
                        </Button>

                        <Button Style="{DynamicResource MaterialDesignFlatButton}"
                                Height="30"
                                Width="60">
                            <materialDesign:PackIcon Kind="cropsquare"
                                                     Foreground="White"
                                                     Height="15"
                                                     Width="15"
                                                     VerticalAlignment="Center"/>
                        </Button>

                        <Button Style="{DynamicResource MaterialDesignFlatButton}"
                                Height="30"
                                Width="60"
                                Margin="0,0,10,0">
                            <materialDesign:PackIcon Kind="close"
                                                     Foreground="White"
                                                     Height="20"
                                                     Width="20"
                                                     VerticalAlignment="Center"/>
                        </Button>


                    </StackPanel>
                </Border>

                <!-- Верхняя навигационная панель -->
                <components:HaderComponent Grid.Row="1"
                                           VerticalAlignment="Stretch"
                                           DataContext="{Binding HaderViewModel}"
                                           Visibility="{Binding DataContext.IsFullscreen, 
                                                        RelativeSource={RelativeSource AncestorType=Window}, 
                                                        Converter={StaticResource BooleanToVisibilityConverter}}"/>

                <!-- Основной контент страницы -->
                <Border Grid.Row="2"
                        Background="{StaticResource DarkBackground}"
                        CornerRadius="0,0,12,0">
                    <ScrollViewer VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled"
                                  VerticalAlignment="Stretch"
                                  HorizontalAlignment="Stretch">

                        <StackPanel Margin="{Binding MarginMainConent}">

                            <ContentControl Content="{Binding CurrentViewModel}">
                                <ContentControl.Resources>
                                    <DataTemplate DataType="{x:Type viewmodels:HomeViewModel}">
                                        <views:HomeView/>
                                    </DataTemplate>
                                    <DataTemplate DataType="{x:Type viewmodels:AnimeInfoViewModel}">
                                        <views:AnimeInfoView/>
                                    </DataTemplate>
                                    <DataTemplate DataType="{x:Type viewmodels:WatchAnimeViewModel}">
                                        <views:WatchAnimeView/>
                                    </DataTemplate>
                                </ContentControl.Resources>
                            </ContentControl>

                            <!--<ListView ItemsSource="{Binding AnimeTitle}"
              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
              SelectionMode="Single"
              Margin="0,15,0,0">
        <ListView.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
        </ListView.ItemsPanel>
        <ListView.ItemTemplate>
            <DataTemplate>
                <Viewbox Stretch="Uniform" MaxWidth="200">
                    <materialDesign:Card Width="210"
                                         Height="322">
                        <StackPanel>
                            
                            <Image Source="{Binding Posters.Original.Url}"
                                   Height="208"
                                   Stretch="UniformToFill"
                                   VerticalAlignment="Top"
                                   HorizontalAlignment="Stretch"/>

                            
                            <StackPanel Margin="10,15">
                                <TextBlock Text="{Binding Names.Ru}"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource TextColor}"
                                           TextWrapping="Wrap"
                                           TextTrimming="CharacterEllipsis"
                                           MaxHeight="20"
                                           FontSize="14"/>

                                <TextBlock Foreground="{StaticResource SecondaryTextColor}"
                                           FontSize="13"
                                           Margin="0,5,0,0">

                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0} эп. - {1}">
                                            <Binding Path="Player.Episodes.Last" />
                                            <Binding Path="Season.Year" />
                                        </MultiBinding>
                                    </TextBlock.Text>

                                </TextBlock>

                                <WrapPanel Margin="0,15,0,0">
                                    <TextBlock Text="{Binding GenresText}" 
                                               FontSize="12"
                                               Margin="0,0,5,0"
                                               Foreground="{StaticResource PrimaryColor}"
                                               Style="{StaticResource BaseTextBlockStyle}"/>
                                </WrapPanel>
                            </StackPanel>
                        </StackPanel>
                    </materialDesign:Card>
                </Viewbox>
            </DataTemplate>
        </ListView.ItemTemplate>
    </ListView>-->

                        </StackPanel>
                    </ScrollViewer>
                    
                </Border>

            </Grid>
        </Grid>
    </Border>


</Window>